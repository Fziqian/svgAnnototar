<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="borderbox">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <title>测试长病例</title>
    <link href="https://cdn.bootcss.com/bootstrap/2.3.1/css/bootstrap.min.css" rel="stylesheet">
    <style>

        .demo {
            max-height: 100vh;
            /*overflow: scroll;*/
        }

        .svgContainer {
            display: inline-block;
            font-family: "Source Sans Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            font-weight: normal;
            font-size: 14px;
            max-width: 1000px;
            /* max-height:500px;    */
            /* overflow: scroll; */
        }
        text tspan{
            font-size: 16px;
        }
        svg .label-view rect{
            stroke: #8c8c8c;
            stroke-width: 1;
        }

    </style>

</head>

<body>
    <div id="demo">
        <div class="svgContainer" id="svgContainer"></div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" id="labelCategoriesModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        模态框（Modal）标题
                    </h4>
                </div>
                <div class="modal-body">
                    <select class="form-control" id="labelCatSel">
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                    </button>
                    <button type="button" id="submitLabelCat" class="btn btn-primary">
                        提交
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" id="connectionCategoriesModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="H1">
                        模态框（Modal）标题
                    </h4>
                </div>
                <div class="modal-body">
                    <select class="form-control" id="curConnectionSel">

                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                    </button>
                    <button type="button" id="submitConnectionCat" class="btn btn-primary">
                        提交
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
</body>
<script src="https://cdn.bootcss.com/jquery/1.11.2/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/2.3.1/js/bootstrap.min.js"></script>
<script src="../dist/Case-SvgAnnotator.js"></script>
<script type="text/javascript">
    var originString = "hello world";
    var str =`{
    "content": "病程记录2017-2-1917:22XXXX，女，65岁，已婚，山西省籍，农民，现住山西省XXXX。主因间断上腹部胀痛不适半年，加重1月于2017-2-19入院。一、病例特点:1、老年女性，65岁。2、病史特点：患者于半年前无明显诱因开始出现上腹部胀痛不适，呈间断性，进食后明显，无明显反酸、嗳气，可自行缓解，未作诊治。此后腹痛症状缓慢加重，持续时间逐步延长，出现食欲下降。近1月来腹痛症状转为持续性，食欲下降明显，约降低1/2，出现黑便，未出现呕血，无呕吐。经口服中药治疗效果欠佳。患者就诊于山西省人民医院，行胃镜检查及活检，提示胃低分化腺癌。现患者为求手术治疗，门诊以胃癌收入我科。患者目前精神状态良好，体力正常，食欲查，睡眠正常，体重下降约5kg，大便正常，排尿正常，为进一步检查及治疗入院。3、查体：一般情况良好，浅表淋巴结无肿大，心肺正常；腹平坦，无腹壁静脉曲张，腹部柔软，上腹部压痛阳性，无反跳痛，未及包块。肝脏未触及，脾脏未触及，Murphy氏征阴性，肾脏无叩击痛，无移动性浊音。肠鸣音正常，4-6次/分。直肠指诊未见异常。4、辅助检查：胃镜（2017-2-7山西省人民医院）：胃体可见一巨大不规则溃疡，表面覆污秽苔，蠕动差，取检质硬。贲门、胃窦、十二指肠球部未见异常。活检病理（2017-2-8山西省人民医院）：胃体倾向为少量低分化癌，建议进一步免疫组化明确诊断。腹部CT（2017-2-15301医院）：胃癌，小网膜囊区淋巴结增大，考虑转移可能性大，肝脏、胆囊、胰腺未见明显异常；左肾结石，右肾错构瘤。脾大。二、拟诊讨论：患者为间断上腹部胀痛不适半年，加重1月，诊断明确为：胃癌，糖尿病，高血压病，现就其诊断及治疗讨论如下：根据患者胃镜、活检病理等辅助检查，目前胃癌诊断明确。该病为消化道最为常见的恶性肿瘤，中老年人多发。早期症状不明显，也无特异性，可表现为上腹部不适、隐痛、嗳气等症状，晚期可有腹部包块、梗阻、腹水、远处转移及恶病质等症状及体征。胃癌诊断有赖于胃镜及活检病理。胃癌的转移有四种途径：直接侵润、淋巴转移、血行转移、种植转移。胃癌治疗依赖于以手术为主的综合治疗。胃切除+D2淋巴结清扫是胃癌的外科标准手术方式。淋巴结清扫范围依据肿瘤部位而不同，主要的标准参照日本胃癌处理规约。胃癌患者预后有赖于术后病理分期及分型。常用的治疗方式主要有以下几种选择：1、手术治疗:(1)内镜切除术：包括EMR和ESD。绝对适应证：2cm以下的肉眼可见的非溃疡型粘膜内癌cT1a，组织类型为分化型；扩大适应证：①2cm以上的非溃疡型分化型粘膜内癌cT1a，②3cm以下的溃疡型分化型粘膜内癌cT1a，③2cm以下的非溃疡型未分化型粘膜内癌cT1a。对于扩大适应症，内镜切除术目前仍是临床研究性质的治疗方法。(2)根治性手术：①标准手术：要求切除2/3以上胃及D2淋巴结清扫术。通常选择全胃切除术或远端胃切除术。对于贲门到肿瘤上缘距离不足5cm的T2期以上肿瘤及不足3cm的T1期肿瘤，应选择全胃切除术，远端胃切除术适用于除此以外的其他T2以上肿瘤。近端胃切除术仅限于胃上部的T1期肿瘤，且需保留1/2以上的胃。②腹腔镜（或机器人）辅助胃癌手术：目前已成为根治早期胃癌及部分进展期胃癌安全可行的手术方式。适应证：胃肿瘤浸润深度在浆膜层T4a以内者，胃癌术前分期考虑为Ⅰ、Ⅱ、ⅢA期者，胃癌的探查与分期，晚期胃癌的姑息性手术。禁忌证：胃肿瘤浸润大面积浆膜层或浆膜外广泛浸润T4b、肿瘤直径大于10cm淋巴结转移灶融合并包绕重要血管、腹腔严重粘连、重度肥胖、胃癌急诊手术以及心肺功能不良者。③非标准手术：根据不同病变程度改变相应切除范围以及淋巴结清扫范围，包括缩小手术：切除范围及淋巴结清扫范围不满足标准手术要求，如D1、D1+等；扩大手术：合并切除其他脏器或D2以上的扩大淋巴结清扫术。（3）非根治性手术：对无法根治的病患进行的手术，分为减瘤手术和姑息手术。①减瘤手术：指对存在非治愈因素（如已有不能切除的肝转移或腹膜转移等），并且无出血、狭窄、疼痛等肿瘤相关症状的病患所进行的胃切除术，其目的为降低体内肿瘤负荷，延缓症状出现或死亡。②姑息手术：指为治疗不能手术切除的胃癌患者出现的出血、狭窄等肿瘤急症而进行的手术。对于因肿瘤而导致的狭窄或持续性出血，可安全行胃切除的病例可行姑息性胃切除术，而对于因切除困难等较危险的情况则应行胃空肠吻合等短路手术。2、化学治疗（1）新辅助化疗：是以消灭微小转移灶为目的，然后对残留的病灶进行切除的综合治疗。新辅助化疗降期可以提高切除率，肿瘤缩小则可能避免进行联合脏器切除。但另一方面，对于化疗无效的情况，则有可能是患者失去手术时机。常用于Ⅱ、Ⅲ期胃癌患者，方案包括SOX、XELOX等。（2）转化化疗：适用于初始评估不能手术切除而有潜在手术可能，经化疗后肿瘤能够被切除的患者。（3）术后辅助化疗：指根治性切除术后为了防止微小残留肿瘤复发而进行的化疗。适用于进展期胃癌患者。此外，对于不可切除、复发肿瘤以及非根治性切除（R2）的患者，化疗则是首选的治疗方案。3、靶向治疗：表皮生长因子受体（EGFR）、血管内皮生长因子受体（VEGFR）和人表皮生长因子受体-2（HER-2）的过表达与胃癌较差的预后相关，因此，可根据情况选择靶向药物联合化疗治疗晚期胃癌。4、放疗：由于胃腺癌对放射线敏感性低，单独放疗疗效不佳，在胃癌治疗中是辅助性的，目前胃癌放疗在国内研究和应用较少。5、其他：免疫治疗如热休克蛋白Gp96自体免疫治疗等手段也开始应用于临床。三、初步诊断：胃癌，糖尿病，高血压病四、诊疗计划：1、拟查计划完成时间血、尿、便常规2017-2-19超声内镜2017-2-19腹部增强CT2017-2-192、治疗：二级护理、半流饮食、完善术前检查，限期手术。XXXX主管医生看过患者，同意目前诊断及处理。XXX病程记录2017-2-1917:22XXXX，女，65岁，已婚，山西省籍，农民，现住山西省XXXX。主因间断上腹部胀痛不适半年，加重1月于2017-2-19入院。一、病例特点:1、老年女性，65岁。2、病史特点：患者于半年前无明显诱因开始出现上腹部胀痛不适，呈间断性，进食后明显，无明显反酸、嗳气，可自行缓解，未作诊治。此后腹痛症状缓慢加重，持续时间逐步延长，出现食欲下降。近1月来腹痛症状转为持续性，食欲下降明显，约降低1/2，出现黑便，未出现呕血，无呕吐。经口服中药治疗效果欠佳。患者就诊于山西省人民医院，行胃镜检查及活检，提示胃低分化腺癌。现患者为求手术治疗，门诊以胃癌收入我科。患者目前精神状态良好，体力正常，食欲查，睡眠正常，体重下降约5kg，大便正常，排尿正常，为进一步检查及治疗入院。3、查体：一般情况良好，浅表淋巴结无肿大，心肺正常；腹平坦，无腹壁静脉曲张，腹部柔软，上腹部压痛阳性，无反跳痛，未及包块。肝脏未触及，脾脏未触及，Murphy氏征阴性，肾脏无叩击痛，无移动性浊音。肠鸣音正常，4-6次/分。直肠指诊未见异常。4、辅助检查：胃镜（2017-2-7山西省人民医院）：胃体可见一巨大不规则溃疡，表面覆污秽苔，蠕动差，取检质硬。贲门、胃窦、十二指肠球部未见异常。活检病理（2017-2-8山西省人民医院）：胃体倾向为少量低分化癌，建议进一步免疫组化明确诊断。腹部CT（2017-2-15301医院）：胃癌，小网膜囊区淋巴结增大，考虑转移可能性大，肝脏、胆囊、胰腺未见明显异常；左肾结石，右肾错构瘤。脾大。二、拟诊讨论：患者为间断上腹部胀痛不适半年，加重1月，诊断明确为：胃癌，糖尿病，高血压病，现就其诊断及治疗讨论如下：根据患者胃镜、活检病理等辅助检查，目前胃癌诊断明确。该病为消化道最为常见的恶性肿瘤，中老年人多发。早期症状不明显，也无特异性，可表现为上腹部不适、隐痛、嗳气等症状，晚期可有腹部包块、梗阻、腹水、远处转移及恶病质等症状及体征。胃癌诊断有赖于胃镜及活检病理。胃癌的转移有四种途径：直接侵润、淋巴转移、血行转移、种植转移。胃癌治疗依赖于以手术为主的综合治疗。胃切除+D2淋巴结清扫是胃癌的外科标准手术方式。淋巴结清扫范围依据肿瘤部位而不同，主要的标准参照日本胃癌处理规约。胃癌患者预后有赖于术后病理分期及分型。常用的治疗方式主要有以下几种选择：1、手术治疗:(1)内镜切除术：包括EMR和ESD。绝对适应证：2cm以下的肉眼可见的非溃疡型粘膜内癌cT1a，组织类型为分化型；扩大适应证：①2cm以上的非溃疡型分化型粘膜内癌cT1a，②3cm以下的溃疡型分化型粘膜内癌cT1a，③2cm以下的非溃疡型未分化型粘膜内癌cT1a。对于扩大适应症，内镜切除术目前仍是临床研究性质的治疗方法。(2)根治性手术：①标准手术：要求切除2/3以上胃及D2淋巴结清扫术。通常选择全胃切除术或远端胃切除术。对于贲门到肿瘤上缘距离不足5cm的T2期以上肿瘤及不足3cm的T1期肿瘤，应选择全胃切除术，远端胃切除术适用于除此以外的其他T2以上肿瘤。近端胃切除术仅限于胃上部的T1期肿瘤，且需保留1/2以上的胃。②腹腔镜（或机器人）辅助胃癌手术：目前已成为根治早期胃癌及部分进展期胃癌安全可行的手术方式。适应证：胃肿瘤浸润深度在浆膜层T4a以内者，胃癌术前分期考虑为Ⅰ、Ⅱ、ⅢA期者，胃癌的探查与分期，晚期胃癌的姑息性手术。禁忌证：胃肿瘤浸润大面积浆膜层或浆膜外广泛浸润T4b、肿瘤直径大于10cm淋巴结转移灶融合并包绕重要血管、腹腔严重粘连、重度肥胖、胃癌急诊手术以及心肺功能不良者。③非标准手术：根据不同病变程度改变相应切除范围以及淋巴结清扫范围，包括缩小手术：切除范围及淋巴结清扫范围不满足标准手术要求，如D1、D1+等；扩大手术：合并切除其他脏器或D2以上的扩大淋巴结清扫术。（3）非根治性手术：对无法根治的病患进行的手术，分为减瘤手术和姑息手术。①减瘤手术：指对存在非治愈因素（如已有不能切除的肝转移或腹膜转移等），并且无出血、狭窄、疼痛等肿瘤相关症状的病患所进行的胃切除术，其目的为降低体内肿瘤负荷，延缓症状出现或死亡。②姑息手术：指为治疗不能手术切除的胃癌患者出现的出血、狭窄等肿瘤急症而进行的手术。对于因肿瘤而导致的狭窄或持续性出血，可安全行胃切除的病例可行姑息性胃切除术，而对于因切除困难等较危险的情况则应行胃空肠吻合等短路手术。2、化学治疗（1）新辅助化疗：是以消灭微小转移灶为目的，然后对残留的病灶进行切除的综合治疗。新辅助化疗降期可以提高切除率，肿瘤缩小则可能避免进行联合脏器切除。但另一方面，对于化疗无效的情况，则有可能是患者失去手术时机。常用于Ⅱ、Ⅲ期胃癌患者，方案包括SOX、XELOX等。（2）转化化疗：适用于初始评估不能手术切除而有潜在手术可能，经化疗后肿瘤能够被切除的患者。（3）术后辅助化疗：指根治性切除术后为了防止微小残留肿瘤复发而进行的化疗。适用于进展期胃癌患者。此外，对于不可切除、复发肿瘤以及非根治性切除（R2）的患者，化疗则是首选的治疗方案。3、靶向治疗：表皮生长因子受体（EGFR）、血管内皮生长因子受体（VEGFR）和人表皮生长因子受体-2（HER-2）的过表达与胃癌较差的预后相关，因此，可根据情况选择靶向药物联合化疗治疗晚期胃癌。4、放疗：由于胃腺癌对放射线敏感性低，单独放疗疗效不佳，在胃癌治疗中是辅助性的，目前胃癌放疗在国内研究和应用较少。5、其他：免疫治疗如热休克蛋白Gp96自体免疫治疗等手段也开始应用于临床。三、初步诊断：胃癌，糖尿病，高血压病四、诊疗计划：1、拟查计划完成时间血、尿、便常规2017-2-19超声内镜2017-2-19腹部增强CT2017-2-192、治疗：二级护理、半流饮食、完善术前检查，限期手术。XXXX主管医生看过患者，同意目前诊断及处理。XXX病程记录2017-2-1917:22XXXX，女，65岁，已婚，山西省籍，农民，现住山西省XXXX。主因间断上腹部胀痛不适半年，加重1月于2017-2-19入院。一、病例特点:1、老年女性，65岁。2、病史特点：患者于半年前无明显诱因开始出现上腹部胀痛不适，呈间断性，进食后明显，无明显反酸、嗳气，可自行缓解，未作诊治。此后腹痛症状缓慢加重，持续时间逐步延长，出现食欲下降。近1月来腹痛症状转为持续性，食欲下降明显，约降低1/2，出现黑便，未出现呕血，无呕吐。经口服中药治疗效果欠佳。患者就诊于山西省人民医院，行胃镜检查及活检，提示胃低分化腺癌。现患者为求手术治疗，门诊以胃癌收入我科。患者目前精神状态良好，体力正常，食欲查，睡眠正常，体重下降约5kg，大便正常，排尿正常，为进一步检查及治疗入院。3、查体：一般情况良好，浅表淋巴结无肿大，心肺正常；腹平坦，无腹壁静脉曲张，腹部柔软，上腹部压痛阳性，无反跳痛，未及包块。肝脏未触及，脾脏未触及，Murphy氏征阴性，肾脏无叩击痛，无移动性浊音。肠鸣音正常，4-6次/分。直肠指诊未见异常。4、辅助检查：胃镜（2017-2-7山西省人民医院）：胃体可见一巨大不规则溃疡，表面覆污秽苔，蠕动差，取检质硬。贲门、胃窦、十二指肠球部未见异常。活检病理（2017-2-8山西省人民医院）：胃体倾向为少量低分化癌，建议进一步免疫组化明确诊断。腹部CT（2017-2-15301医院）：胃癌，小网膜囊区淋巴结增大，考虑转移可能性大，肝脏、胆囊、胰腺未见明显异常；左肾结石，右肾错构瘤。脾大。二、拟诊讨论：患者为间断上腹部胀痛不适半年，加重1月，诊断明确为：胃癌，糖尿病，高血压病，现就其诊断及治疗讨论如下：根据患者胃镜、活检病理等辅助检查，目前胃癌诊断明确。该病为消化道最为常见的恶性肿瘤，中老年人多发。早期症状不明显，也无特异性，可表现为上腹部不适、隐痛、嗳气等症状，晚期可有腹部包块、梗阻、腹水、远处转移及恶病质等症状及体征。胃癌诊断有赖于胃镜及活检病理。胃癌的转移有四种途径：直接侵润、淋巴转移、血行转移、种植转移。胃癌治疗依赖于以手术为主的综合治疗。胃切除+D2淋巴结清扫是胃癌的外科标准手术方式。淋巴结清扫范围依据肿瘤部位而不同，主要的标准参照日本胃癌处理规约。胃癌患者预后有赖于术后病理分期及分型。常用的治疗方式主要有以下几种选择：1、手术治疗:(1)内镜切除术：包括EMR和ESD。绝对适应证：2cm以下的肉眼可见的非溃疡型粘膜内癌cT1a，组织类型为分化型；扩大适应证：①2cm以上的非溃疡型分化型粘膜内癌cT1a，②3cm以下的溃疡型分化型粘膜内癌cT1a，③2cm以下的非溃疡型未分化型粘膜内癌cT1a。对于扩大适应症，内镜切除术目前仍是临床研究性质的治疗方法。(2)根治性手术：①标准手术：要求切除2/3以上胃及D2淋巴结清扫术。通常选择全胃切除术或远端胃切除术。对于贲门到肿瘤上缘距离不足5cm的T2期以上肿瘤及不足3cm的T1期肿瘤，应选择全胃切除术，远端胃切除术适用于除此以外的其他T2以上肿瘤。近端胃切除术仅限于胃上部的T1期肿瘤，且需保留1/2以上的胃。②腹腔镜（或机器人）辅助胃癌手术：目前已成为根治早期胃癌及部分进展期胃癌安全可行的手术方式。适应证：胃肿瘤浸润深度在浆膜层T4a以内者，胃癌术前分期考虑为Ⅰ、Ⅱ、ⅢA期者，胃癌的探查与分期，晚期胃癌的姑息性手术。禁忌证：胃肿瘤浸润大面积浆膜层或浆膜外广泛浸润T4b、肿瘤直径大于10cm淋巴结转移灶融合并包绕重要血管、腹腔严重粘连、重度肥胖、胃癌急诊手术以及心肺功能不良者。③非标准手术：根据不同病变程度改变相应切除范围以及淋巴结清扫范围，包括缩小手术：切除范围及淋巴结清扫范围不满足标准手术要求，如D1、D1+等；扩大手术：合并切除其他脏器或D2以上的扩大淋巴结清扫术。（3）非根治性手术：对无法根治的病患进行的手术，分为减瘤手术和姑息手术。①减瘤手术：指对存在非治愈因素（如已有不能切除的肝转移或腹膜转移等），并且无出血、狭窄、疼痛等肿瘤相关症状的病患所进行的胃切除术，其目的为降低体内肿瘤负荷，延缓症状出现或死亡。②姑息手术：指为治疗不能手术切除的胃癌患者出现的出血、狭窄等肿瘤急症而进行的手术。对于因肿瘤而导致的狭窄或持续性出血，可安全行胃切除的病例可行姑息性胃切除术，而对于因切除困难等较危险的情况则应行胃空肠吻合等短路手术。2、化学治疗（1）新辅助化疗：是以消灭微小转移灶为目的，然后对残留的病灶进行切除的综合治疗。新辅助化疗降期可以提高切除率，肿瘤缩小则可能避免进行联合脏器切除。但另一方面，对于化疗无效的情况，则有可能是患者失去手术时机。常用于Ⅱ、Ⅲ期胃癌患者，方案包括SOX、XELOX等。（2）转化化疗：适用于初始评估不能手术切除而有潜在手术可能，经化疗后肿瘤能够被切除的患者。（3）术后辅助化疗：指根治性切除术后为了防止微小残留肿瘤复发而进行的化疗。适用于进展期胃癌患者。此外，对于不可切除、复发肿瘤以及非根治性切除（R2）的患者，化疗则是首选的治疗方案。3、靶向治疗：表皮生长因子受体（EGFR）、血管内皮生长因子受体（VEGFR）和人表皮生长因子受体-2（HER-2）的过表达与胃癌较差的预后相关，因此，可根据情况选择靶向药物联合化疗治疗晚期胃癌。4、放疗：由于胃腺癌对放射线敏感性低，单独放疗疗效不佳，在胃癌治疗中是辅助性的，目前胃癌放疗在国内研究和应用较少。5、其他：免疫治疗如热休克蛋白Gp96自体免疫治疗等手段也开始应用于临床。三、初步诊断：胃癌，糖尿病，高血压病四、诊疗计划：1、拟查计划完成时间血、尿、便常规2017-2-19超声内镜2017-2-19腹部增强CT2017-2-192、治疗：二级护理、半流饮食、完善术前检查，限期手术。XXXX主管医生看过患者，同意目前诊断及处理。XXX",
    "labelCategories": [
        {
            "id": 0,
            "text": "疾病和诊断",
            "color": "#ff8888",
            "borderColor": "#965f3f",
            "attributes": {
                "code": "disease",
                "assertTypeNo": 1
            }
        },
        {
            "id": 1,
            "text": "症状和体征",
            "color": "#fdb2e1",
            "borderColor": "#000080",
            "attributes": {
                "code": "symptom",
                "assertTypeNo": 0
            }
        },
        {
            "id": 2,
            "text": "身体部位",
            "color": "#6dd5fd",
            "borderColor": "#613C9D",
            "attributes": {
                "code": "body",
                "assertTypeNo": 0
            }
        },
        {
            "id": 3,
            "text": "检查和检验",
            "color": "#ffc36b",
            "borderColor": "#965f3f",
            "attributes": {
                "code": "check",
                "assertTypeNo": 0
            }
        },
        {
            "id": 4,
            "text": "治疗",
            "color": "#00ff00",
            "borderColor": "#965f3f",
            "attributes": {
                "code": "treatment",
                "assertTypeNo": 1
            }
        }
    ],
    "labels": [
        {
            "id": 0,
            "categoryId": 0,
            "startIndex": 29,
            "endIndex": 31,
            "attributes": {
                "assertTypeCode": "present",
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 1,
            "categoryId": 0,
            "startIndex": 111,
            "endIndex": 113,
            "attributes": {
                "assertTypeCode": "present",
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 2,
            "categoryId": 0,
            "startIndex": 121,
            "endIndex": 123,
            "attributes": {
                "assertTypeCode": "present",
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 3,
            "categoryId": 1,
            "startIndex": 214,
            "endIndex": 216,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 4,
            "categoryId": 1,
            "startIndex": 134,
            "endIndex": 135,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 5,
            "categoryId": 2,
            "startIndex": 65,
            "endIndex": 67,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 6,
            "categoryId": 3,
            "startIndex": 209,
            "endIndex": 211,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 7,
            "categoryId": 3,
            "startIndex": 218,
            "endIndex": 219,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 8,
            "categoryId": 1,
            "startIndex": 222,
            "endIndex": 223,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 9,
            "categoryId": 2,
            "startIndex": 176,
            "endIndex": 178,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 10,
            "categoryId": 3,
            "startIndex": 116,
            "endIndex": 118,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 11,
            "categoryId": 1,
            "startIndex": 78,
            "endIndex": 79,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 12,
            "categoryId": 3,
            "startIndex": 68,
            "endIndex": 70,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 13,
            "categoryId": 4,
            "startIndex": 72,
            "endIndex": 74,
            "attributes": {
                "assertTypeCode": "present",
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 14,
            "categoryId": 1,
            "startIndex": 61,
            "endIndex": 62,
            "attributes": {
                "assertTypeCode": null,
                "unsureness": false,
                "signUser": "a"
            }
        },
        {
            "id": 15,
            "categoryId": 4,
            "startIndex": 63,
            "endIndex": 64,
            "attributes": {
                "assertTypeCode": "present",
                "unsureness": false,
                "signUser": "a"
            }
        }
    ],
    "connectionCategories": [
        {
            "id": 0,
            "text": "治疗改善了疾病",
            "attributes": {
                "relationRuleCode": "Tr2D",
                "code": "TrID"
            }
        },
        {
            "id": 1,
            "text": "治疗恶化了疾病",
            "attributes": {
                "relationRuleCode": "Tr2D",
                "code": "TrWD"
            }
        },
        {
            "id": 2,
            "text": "治疗导致了疾病",
            "attributes": {
                "relationRuleCode": "Tr2D",
                "code": "TrCD"
            }
        },
        {
            "id": 3,
            "text": "治疗施加于疾病",
            "attributes": {
                "relationRuleCode": "Tr2D",
                "code": "TrAD"
            }
        },
        {
            "id": 4,
            "text": "因为疾病而没有采取治疗",
            "attributes": {
                "relationRuleCode": "Tr2D",
                "code": "TrNAD"
            }
        },
        {
            "id": 5,
            "text": "治疗改善了症状",
            "attributes": {
                "relationRuleCode": "Tr2S",
                "code": "TrIS"
            }
        },
        {
            "id": 6,
            "text": "治疗恶化了症状",
            "attributes": {
                "relationRuleCode": "Tr2S",
                "code": "TrWS"
            }
        },
        {
            "id": 7,
            "text": "治疗导致了症状",
            "attributes": {
                "relationRuleCode": "Tr2S",
                "code": "TrCS"
            }
        },
        {
            "id": 8,
            "text": "治疗施加于症状",
            "attributes": {
                "relationRuleCode": "Tr2S",
                "code": "TrAS"
            }
        },
        {
            "id": 9,
            "text": "因为症状而没有采取治疗",
            "attributes": {
                "relationRuleCode": "Tr2S",
                "code": "TrNAS"
            }
        },
        {
            "id": 10,
            "text": "检查证实了疾病",
            "attributes": {
                "relationRuleCode": "Ch2D",
                "code": "ChRD"
            }
        },
        {
            "id": 11,
            "text": "为了证实疾病而采取检查",
            "attributes": {
                "relationRuleCode": "Ch2D",
                "code": "ChCD"
            }
        },
        {
            "id": 12,
            "text": "检查证实了症状",
            "attributes": {
                "relationRuleCode": "Ch2S",
                "code": "ChRS"
            }
        },
        {
            "id": 13,
            "text": "因为症状而采取检查",
            "attributes": {
                "relationRuleCode": "Ch2S",
                "code": "ChAS"
            }
        },
        {
            "id": 14,
            "text": "疾病导致了症状",
            "attributes": {
                "relationRuleCode": "D2S",
                "code": "DCS"
            }
        },
        {
            "id": 15,
            "text": "症状表明了疾病",
            "attributes": {
                "relationRuleCode": "D2S",
                "code": "SID"
            }
        },
        {
            "id": 16,
            "text": "身体部位患了疾病",
            "attributes": {
                "relationRuleCode": "B2D",
                "code": "DeAB"
            }
        },
        {
            "id": 17,
            "text": "身体部位没有患疾病",
            "attributes": {
                "relationRuleCode": "B2D",
                "code": "DeMB"
            }
        },
        {
            "id": 18,
            "text": "疾病在身体部位转移了",
            "attributes": {
                "relationRuleCode": "B2D",
                "code": "BoMD"
            }
        },
        {
            "id": 19,
            "text": "身体部位的疾病加重了",
            "attributes": {
                "relationRuleCode": "B2D",
                "code": "DeIB"
            }
        },
        {
            "id": 20,
            "text": "身体部位的疾病减轻了",
            "attributes": {
                "relationRuleCode": "B2D",
                "code": "DeDB"
            }
        },
        {
            "id": 21,
            "text": "身体部位的疾病痊愈了",
            "attributes": {
                "relationRuleCode": "B2D",
                "code": "DeMB"
            }
        },
        {
            "id": 22,
            "text": "身体部位出现了症状",
            "attributes": {
                "relationRuleCode": "B2S",
                "code": "BoAS"
            }
        },
        {
            "id": 23,
            "text": "身体部位没有出现症状",
            "attributes": {
                "relationRuleCode": "B2S",
                "code": "BoNS"
            }
        },
        {
            "id": 24,
            "text": "身体部位的症状减轻了",
            "attributes": {
                "relationRuleCode": "B2S",
                "code": "BoDS"
            }
        },
        {
            "id": 25,
            "text": "身体部位的症状加重了",
            "attributes": {
                "relationRuleCode": "B2S",
                "code": "BoIS"
            }
        },
        {
            "id": 26,
            "text": "身体部位的症状消失了",
            "attributes": {
                "relationRuleCode": "B2S",
                "code": "BoMS"
            }
        },
        {
            "id": 27,
            "text": "身体部位做了检查",
            "attributes": {
                "relationRuleCode": "B2C",
                "code": "BoAC"
            }
        },
        {
            "id": 28,
            "text": "身体部位未做检查",
            "attributes": {
                "relationRuleCode": "B2C",
                "code": "BoNC"
            }
        }
    ],
    "connections": [
        {
            "id": 0,
            "categoryId": 0,
            "fromId": 0,
            "toId": 13
        },
        {
            "id": 1,
            "categoryId": 12,
            "fromId": 12,
            "toId": 11
        },
        {
            "id": 2,
            "categoryId": 12,
            "fromId": 14,
            "toId": 12
        },
        {
            "id": 3,
            "categoryId": 22,
            "fromId": 5,
            "toId": 14
        },
        {
            "id": 4,
            "categoryId": 27,
            "fromId": 10,
            "toId": 5
        },
        {
            "id": 5,
            "categoryId": 14,
            "fromId": 4,
            "toId": 2
        },
        {
            "id": 6,
            "categoryId": 14,
            "fromId": 1,
            "toId": 4
        },
        {
            "id": 7,
            "categoryId": 27,
            "fromId": 6,
            "toId": 9
        },
        {
            "id": 8,
            "categoryId": 27,
            "fromId": 7,
            "toId": 9
        },
        {
            "id": 9,
            "categoryId": 12,
            "fromId": 7,
            "toId": 3
        },
        {
            "id": 10,
            "categoryId": 12,
            "fromId": 8,
            "toId": 6
        },
        {
            "id": 11,
            "categoryId": 22,
            "fromId": 5,
            "toId": 11
        }
    ]
}`;
var obj=JSON.parse(str)

    function bindSelHtml() {
        var labelHtml = "";
        for (var i = 0; i < obj.labelCategories.length; i++) {
            labelHtml += '<option value="' + obj.labelCategories[i].id + '">' + obj.labelCategories[i].text +
                '</option>';
        }
        $("#labelCatSel").html(labelHtml);

        var labelCatHtml = "";
        for (var i = 0; i < obj.connectionCategories.length; i++) {
            labelCatHtml += '<option value="' + obj.connectionCategories[i].id + '">' + obj.connectionCategories[i].text +
                '</option>';
        }
        $("#curConnectionSel").html(labelCatHtml);
    }


    bindSelHtml();
    var contentFiltered=obj.content.replace(/[ \u3000]+/g," ");

    var segContainer = document.getElementById("svgContainer");
    var an = $.SvgAnnotator(segContainer, obj, {
        allowMultipleLabel: false,
        maxLineWidth: 50,
        textSelected: function (startIndex, endIndex) {

            $("#labelCategoriesModal").modal("show");

            $("#submitLabelCat").off("click").on("click", function () {

                var curLabelCatId = $("#labelCatSel").val();
                an.createLabel(parseInt(curLabelCatId), startIndex, endIndex);
                console.log(contentFiltered.slice(startIndex,endIndex))
                $("#labelCategoriesModal").modal("hide");
            });
        },
        labelClicked: function (id) {
            //
        },
        twoLabelsClicked: function (first, second) {
            $("#connectionCategoriesModal").modal("show");

            $("#submitConnectionCat").off("click").on("click", function () {
                var curConnectionCatId = $("#curConnectionSel").val();
                an.createConnection(parseInt(curConnectionCatId), first, second);
                $("#connectionCategoriesModal").modal("hide");
            });
        },
        labelRightClicked: function (id, x, y) {
            an.deleteLabel(id);
        },
        connectionRightClicked: function (id, x, y) {
            an.deleteConnection(id);
        }
    });
</script>

</html>